\hypertarget{gquad_8h_source}{}\section{gquad.\+h}
\label{gquad_8h_source}\index{Vienna\+R\+N\+A/gquad.\+h@{Vienna\+R\+N\+A/gquad.\+h}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#ifndef VIENNA\_RNA\_PACKAGE\_GQUAD\_H}
00002 \textcolor{preprocessor}{#define VIENNA\_RNA\_PACKAGE\_GQUAD\_H}
00003 
00004 \textcolor{preprocessor}{#include <\hyperlink{datastructures_2basic_8h}{ViennaRNA/datastructures/basic.h}>}
00005 \textcolor{preprocessor}{#include <\hyperlink{params_2basic_8h}{ViennaRNA/params/basic.h}>}
00006 
00007 \textcolor{preprocessor}{#ifndef INLINE}
00008 \textcolor{preprocessor}{#ifdef \_\_GNUC\_\_}
00009 \textcolor{preprocessor}{# define INLINE inline}
00010 \textcolor{preprocessor}{#else}
00011 \textcolor{preprocessor}{# define INLINE}
00012 \textcolor{preprocessor}{#endif}
00013 \textcolor{preprocessor}{#endif}
00014 
00029 \textcolor{keywordtype}{int}         E\_gquad(\textcolor{keywordtype}{int}           L,
00030                     \textcolor{keywordtype}{int}           l[3],
00031                     \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P);
00032 
00033 
00034 \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}  exp\_E\_gquad(\textcolor{keywordtype}{int}               L,
00035                         \textcolor{keywordtype}{int}               l[3],
00036                         \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}  *pf);
00037 
00038 
00039 \textcolor{keywordtype}{int}         E\_gquad\_ali(\textcolor{keywordtype}{int}           i,
00040                         \textcolor{keywordtype}{int}           L,
00041                         \textcolor{keywordtype}{int}           l[3],
00042                         \textcolor{keyword}{const} \textcolor{keywordtype}{short}   **S,
00043                         \textcolor{keywordtype}{int}           n\_seq,
00044                         \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P);
00045 
00046 
00047 \textcolor{keywordtype}{void} E\_gquad\_ali\_en(\textcolor{keywordtype}{int}           i,
00048                     \textcolor{keywordtype}{int}           L,
00049                     \textcolor{keywordtype}{int}           l[3],
00050                     \textcolor{keyword}{const} \textcolor{keywordtype}{short}   **S,
00051                     \textcolor{keywordtype}{int}           n\_seq,
00052                     \textcolor{keywordtype}{int}           en[2],
00053                     \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P);
00054 
00055 
00072 \textcolor{keywordtype}{int} *\hyperlink{group__gquads_ga392e45c9615aa123737671603fa4203c}{get\_gquad\_matrix}(\textcolor{keywordtype}{short}         *S,
00073                       \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P);
00074 
00075 
00076 \textcolor{keywordtype}{int} *get\_gquad\_ali\_matrix(\textcolor{keywordtype}{short}         *S\_cons,
00077                           \textcolor{keywordtype}{short}         **S,
00078                           \textcolor{keywordtype}{int}           n\_seq,
00079                           \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P);
00080 
00081 
00082 \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL} *get\_gquad\_pf\_matrix(\textcolor{keywordtype}{short}             *S,
00083                                 \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}        *scale,
00084                                 \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}  *pf);
00085 
00086 
00087 \textcolor{keywordtype}{int} **get\_gquad\_L\_matrix(\textcolor{keywordtype}{short}        *S,
00088                          \textcolor{keywordtype}{int}          start,
00089                          \textcolor{keywordtype}{int}          maxdist,
00090                          \textcolor{keywordtype}{int}          n,
00091                          \textcolor{keywordtype}{int}          **g,
00092                          \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P);
00093 
00094 
00095 \textcolor{keywordtype}{void}        vrna\_gquad\_mx\_local\_update(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00096                                        \textcolor{keywordtype}{int}                  start);
00097 
00098 
00099 \textcolor{keywordtype}{void} get\_gquad\_pattern\_mfe(\textcolor{keywordtype}{short}        *S,
00100                            \textcolor{keywordtype}{int}          i,
00101                            \textcolor{keywordtype}{int}          j,
00102                            \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P,
00103                            \textcolor{keywordtype}{int}          *L,
00104                            \textcolor{keywordtype}{int}          l[3]);
00105 
00106 
00107 \textcolor{keywordtype}{void}
00108 get\_gquad\_pattern\_exhaustive(\textcolor{keywordtype}{short}        *S,
00109                              \textcolor{keywordtype}{int}          i,
00110                              \textcolor{keywordtype}{int}          j,
00111                              \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P,
00112                              \textcolor{keywordtype}{int}          *L,
00113                              \textcolor{keywordtype}{int}          *l,
00114                              \textcolor{keywordtype}{int}          threshold);
00115 
00116 
00117 \textcolor{keywordtype}{void} get\_gquad\_pattern\_pf(\textcolor{keywordtype}{short}             *S,
00118                           \textcolor{keywordtype}{int}               i,
00119                           \textcolor{keywordtype}{int}               j,
00120                           \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}  *pf,
00121                           \textcolor{keywordtype}{int}               *L,
00122                           \textcolor{keywordtype}{int}               l[3]);
00123 
00124 
00125 \hyperlink{group__struct__utils__plist_structvrna__elem__prob__s}{plist} *get\_plist\_gquad\_from\_pr(\textcolor{keywordtype}{short}            *S,
00126                                \textcolor{keywordtype}{int}              gi,
00127                                \textcolor{keywordtype}{int}              gj,
00128                                \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}       *G,
00129                                \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}       *probs,
00130                                \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}       *scale,
00131                                \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t} *pf);
00132 
00133 
00134 \hyperlink{group__struct__utils__plist_structvrna__elem__prob__s}{plist} *get\_plist\_gquad\_from\_pr\_max(\textcolor{keywordtype}{short}            *S,
00135                                    \textcolor{keywordtype}{int}              gi,
00136                                    \textcolor{keywordtype}{int}              gj,
00137                                    \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}       *G,
00138                                    \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}       *probs,
00139                                    \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}       *scale,
00140                                    \textcolor{keywordtype}{int}              *L,
00141                                    \textcolor{keywordtype}{int}              l[3],
00142                                    \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t} *pf);
00143 
00144 
00145 \hyperlink{group__struct__utils__plist_structvrna__elem__prob__s}{plist} *get\_plist\_gquad\_from\_db(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *structure,
00146                                \textcolor{keywordtype}{float}      \hyperlink{fold__vars_8h_ac98ec419070aee6831b44e5c700f090f}{pr});
00147 
00148 
00149 \textcolor{keywordtype}{int}         get\_gquad\_count(\textcolor{keywordtype}{short} *S,
00150                             \textcolor{keywordtype}{int}   i,
00151                             \textcolor{keywordtype}{int}   j);
00152 
00153 
00154 \textcolor{keywordtype}{int}         get\_gquad\_layer\_count(\textcolor{keywordtype}{short} *S,
00155                                   \textcolor{keywordtype}{int}   i,
00156                                   \textcolor{keywordtype}{int}   j);
00157 
00158 
00159 \textcolor{keywordtype}{void} get\_gquad\_pattern\_mfe\_ali(\textcolor{keywordtype}{short}        **S,
00160                                \textcolor{keywordtype}{short}        *S\_cons,
00161                                \textcolor{keywordtype}{int}          n\_seq,
00162                                \textcolor{keywordtype}{int}          i,
00163                                \textcolor{keywordtype}{int}          j,
00164                                \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P,
00165                                \textcolor{keywordtype}{int}          *L,
00166                                \textcolor{keywordtype}{int}          l[3]);
00167 
00168 
00179 \textcolor{keywordtype}{int} \hyperlink{group__gquads_gae41763215b9c64d2a7b67f0df8a28078}{parse\_gquad}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}  *struc,
00180                 \textcolor{keywordtype}{int}         *L,
00181                 \textcolor{keywordtype}{int}         l[3]);
00182 
00183 
00184 INLINE PRIVATE \textcolor{keywordtype}{int} \hyperlink{group__gquads_ga220c41e8dbcee940ac975b8ce88e55c5}{backtrack\_GQuad\_IntLoop}(\textcolor{keywordtype}{int}          c,
00185                                            \textcolor{keywordtype}{int}          i,
00186                                            \textcolor{keywordtype}{int}          j,
00187                                            \textcolor{keywordtype}{int}          type,
00188                                            \textcolor{keywordtype}{short}        *S,
00189                                            \textcolor{keywordtype}{int}          *ggg,
00190                                            \textcolor{keywordtype}{int}          *index,
00191                                            \textcolor{keywordtype}{int}          *p,
00192                                            \textcolor{keywordtype}{int}          *q,
00193                                            \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P);
00194 
00195 
00196 INLINE PRIVATE \textcolor{keywordtype}{int} backtrack\_GQuad\_IntLoop\_comparative(\textcolor{keywordtype}{int}          c,
00197                                                        \textcolor{keywordtype}{int}          i,
00198                                                        \textcolor{keywordtype}{int}          j,
00199                                                        \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *type,
00200                                                        \textcolor{keywordtype}{short}        *S\_cons,
00201                                                        \textcolor{keywordtype}{short}        **S5,
00202                                                        \textcolor{keywordtype}{short}        **S3,
00203                                                        \textcolor{keywordtype}{int}          *ggg,
00204                                                        \textcolor{keywordtype}{int}          *index,
00205                                                        \textcolor{keywordtype}{int}          *p,
00206                                                        \textcolor{keywordtype}{int}          *q,
00207                                                        \textcolor{keywordtype}{int}          n\_seq,
00208                                                        \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P);
00209 
00210 
00211 INLINE PRIVATE \textcolor{keywordtype}{int} \hyperlink{group__gquads_ga7b371308fa5a45c7ac353ef6ed1014de}{backtrack\_GQuad\_IntLoop\_L}(\textcolor{keywordtype}{int}          c,
00212                                              \textcolor{keywordtype}{int}          i,
00213                                              \textcolor{keywordtype}{int}          j,
00214                                              \textcolor{keywordtype}{int}          type,
00215                                              \textcolor{keywordtype}{short}        *S,
00216                                              \textcolor{keywordtype}{int}          **ggg,
00217                                              \textcolor{keywordtype}{int}          maxdist,
00218                                              \textcolor{keywordtype}{int}          *p,
00219                                              \textcolor{keywordtype}{int}          *q,
00220                                              \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P);
00221 
00222 
00223 PRIVATE INLINE \textcolor{keywordtype}{int}
00224 vrna\_BT\_gquad\_int(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00225                   \textcolor{keywordtype}{int}                   i,
00226                   \textcolor{keywordtype}{int}                   j,
00227                   \textcolor{keywordtype}{int}                   en,
00228                   \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}       *bp\_stack,
00229                   \textcolor{keywordtype}{int}                   *stack\_count);
00230 
00231 
00232 PRIVATE INLINE \textcolor{keywordtype}{int}
00233 vrna\_BT\_gquad\_mfe(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00234                   \textcolor{keywordtype}{int}                   i,
00235                   \textcolor{keywordtype}{int}                   j,
00236                   \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}       *bp\_stack,
00237                   \textcolor{keywordtype}{int}                   *stack\_count)
00238 \{
00239   \textcolor{comment}{/*}
00240 \textcolor{comment}{   * here we do some fancy stuff to backtrace the stacksize and linker lengths}
00241 \textcolor{comment}{   * of the g-quadruplex that should reside within position i,j}
00242 \textcolor{comment}{   */}
00243   \textcolor{keywordtype}{short}         *S;
00244   \textcolor{keywordtype}{int}           l[3], L, a, n\_seq;
00245   \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P;
00246 
00247   \textcolor{keywordflow}{if} (vc) \{
00248     P = vc->\hyperlink{group__fold__compound_a19b8720c2c5321c1b97c830bd17566ea}{params};
00249     \textcolor{keywordflow}{switch} (vc->\hyperlink{group__fold__compound_a391bcf8ac5997784aaf780cdd251c464}{type}) \{
00250       \textcolor{keywordflow}{case} \hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6}{VRNA\_FC\_TYPE\_SINGLE}:
00251         S = vc->sequence\_encoding2;
00252         L = -1;
00253 
00254         get\_gquad\_pattern\_mfe(S, i, j, P, &L, l);
00255         \textcolor{keywordflow}{break};
00256 
00257       \textcolor{keywordflow}{case} \hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023}{VRNA\_FC\_TYPE\_COMPARATIVE}:
00258         n\_seq = vc->\hyperlink{group__fold__compound_a614702ab74478e786272be44f8cebfe3}{n\_seq};
00259         L     = -1;
00260         get\_gquad\_pattern\_mfe\_ali(vc->\hyperlink{group__fold__compound_aebb37297f92c7bd22aac6343f8f61d61}{S}, vc->\hyperlink{group__fold__compound_aa3fab7ae38ebfed2028375221d295686}{S\_cons}, n\_seq, i, j, P, &L, l);
00261         \textcolor{keywordflow}{break};
00262     \}
00263 
00264     \textcolor{keywordflow}{if} (L != -1) \{
00265       \textcolor{comment}{/* fill the G's of the quadruplex into base\_pair2 */}
00266       \textcolor{keywordflow}{for} (a = 0; a < L; a++) \{
00267         bp\_stack[++(*stack\_count)].i  = i + a;
00268         bp\_stack[(*stack\_count)].j    = i + a;
00269         bp\_stack[++(*stack\_count)].i  = i + L + l[0] + a;
00270         bp\_stack[(*stack\_count)].j    = i + L + l[0] + a;
00271         bp\_stack[++(*stack\_count)].i  = i + L + l[0] + L + l[1] + a;
00272         bp\_stack[(*stack\_count)].j    = i + L + l[0] + L + l[1] + a;
00273         bp\_stack[++(*stack\_count)].i  = i + L + l[0] + L + l[1] + L + l[2] + a;
00274         bp\_stack[(*stack\_count)].j    = i + L + l[0] + L + l[1] + L + l[2] + a;
00275       \}
00276       \textcolor{keywordflow}{return} 1;
00277     \} \textcolor{keywordflow}{else} \{
00278       \textcolor{keywordflow}{return} 0;
00279     \}
00280   \}
00281 
00282   \textcolor{keywordflow}{return} 0;
00283 \}
00284 
00285 
00286 PRIVATE INLINE \textcolor{keywordtype}{int}
00287 vrna\_BT\_gquad\_int(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00288                   \textcolor{keywordtype}{int}                   i,
00289                   \textcolor{keywordtype}{int}                   j,
00290                   \textcolor{keywordtype}{int}                   en,
00291                   \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}       *bp\_stack,
00292                   \textcolor{keywordtype}{int}                   *stack\_count)
00293 \{
00294   \textcolor{keywordtype}{int}           energy, \hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}, *idx, ij, p, q, maxl, minl, c0, l1, *ggg;
00295   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} type;
00296   \textcolor{keywordtype}{char}          *ptype;
00297   \textcolor{keywordtype}{short}         si, sj, *S, *S1;
00298 
00299   \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P;
00300   \hyperlink{group__model__details_structvrna__md__s}{vrna\_md\_t}     *md;
00301 
00302   idx     = vc->\hyperlink{group__fold__compound_a5037235dee512efd85ca543780bbca1a}{jindx};
00303   ij      = idx[j] + i;
00304   P       = vc->\hyperlink{group__fold__compound_a19b8720c2c5321c1b97c830bd17566ea}{params};
00305   md      = &(P->\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details});
00306   ptype   = vc->\hyperlink{group__fold__compound_a3fbea559f1d1976b2d67c215cdeee0b2}{ptype};
00307   type    = (\textcolor{keywordtype}{unsigned} char)ptype[ij];
00308   S1      = vc->\hyperlink{group__fold__compound_a9934bdb695d35a3544285cbcc19f9763}{sequence\_encoding};
00309   S       = vc->sequence\_encoding2;
00310   dangles = md->\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles};
00311   si      = S1[i + 1];
00312   sj      = S1[j - 1];
00313   ggg     = vc->\hyperlink{group__fold__compound_aca8be7bdc65bafe2172c6ee777f18568}{matrices}->\hyperlink{group__dp__matrices_a0b7b86a5c75c96eabb89eb53a13e7164}{ggg};
00314   energy  = 0;
00315 
00316   \textcolor{keywordflow}{if} (dangles == 2)
00317     energy += P->mismatchI[type][si][sj];
00318 
00319   \textcolor{keywordflow}{if} (type > 2)
00320     energy += P->TerminalAU;
00321 
00322   p = i + 1;
00323   \textcolor{keywordflow}{if} (S1[p] == 3) \{
00324     \textcolor{keywordflow}{if} (p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{
00325       minl  = j - i + p - \hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP} - 2;
00326       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00327       minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minl);
00328       c0    = j - 3;
00329       maxl  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00330       maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxl);
00331       \textcolor{keywordflow}{for} (q = minl; q < maxl; q++) \{
00332         \textcolor{keywordflow}{if} (S[q] != 3)
00333           \textcolor{keywordflow}{continue};
00334 
00335         \textcolor{keywordflow}{if} (en == energy + ggg[idx[q] + p] + P->internal\_loop[j - q - 1])
00336           \textcolor{keywordflow}{return} vrna\_BT\_gquad\_mfe(vc, p, q, bp\_stack, stack\_count);
00337       \}
00338     \}
00339   \}
00340 
00341   \textcolor{keywordflow}{for} (p = i + 2;
00342        p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
00343        p++) \{
00344     l1 = p - i - 1;
00345     \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00346       \textcolor{keywordflow}{break};
00347 
00348     \textcolor{keywordflow}{if} (S1[p] != 3)
00349       \textcolor{keywordflow}{continue};
00350 
00351     minl  = j - i + p - MAXLOOP - 2;
00352     c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00353     minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minl);
00354     c0    = j - 1;
00355     maxl  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00356     maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxl);
00357     \textcolor{keywordflow}{for} (q = minl; q < maxl; q++) \{
00358       \textcolor{keywordflow}{if} (S1[q] != 3)
00359         \textcolor{keywordflow}{continue};
00360 
00361       \textcolor{keywordflow}{if} (en == energy + ggg[idx[q] + p] + P->internal\_loop[l1 + j - q - 1])
00362         \textcolor{keywordflow}{return} vrna\_BT\_gquad\_mfe(vc, p, q, bp\_stack, stack\_count);
00363     \}
00364   \}
00365 
00366   q = j - 1;
00367   \textcolor{keywordflow}{if} (S1[q] == 3)
00368     \textcolor{keywordflow}{for} (p = i + 4;
00369          p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
00370          p++) \{
00371       l1 = p - i - 1;
00372       \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00373         \textcolor{keywordflow}{break};
00374 
00375       \textcolor{keywordflow}{if} (S1[p] != 3)
00376         \textcolor{keywordflow}{continue};
00377 
00378       \textcolor{keywordflow}{if} (en == energy + ggg[idx[q] + p] + P->internal\_loop[l1])
00379         \textcolor{keywordflow}{return} vrna\_BT\_gquad\_mfe(vc, p, q, bp\_stack, stack\_count);
00380     \}
00381 
00382   \textcolor{keywordflow}{return} 0;
00383 \}
00384 
00385 
00403 INLINE PRIVATE \textcolor{keywordtype}{int}
\Hypertarget{gquad_8h_source_l00404}\hyperlink{group__gquads_ga220c41e8dbcee940ac975b8ce88e55c5}{00404} \hyperlink{group__gquads_ga220c41e8dbcee940ac975b8ce88e55c5}{backtrack\_GQuad\_IntLoop}(\textcolor{keywordtype}{int}           c,
00405                         \textcolor{keywordtype}{int}           i,
00406                         \textcolor{keywordtype}{int}           j,
00407                         \textcolor{keywordtype}{int}           type,
00408                         \textcolor{keywordtype}{short}         *S,
00409                         \textcolor{keywordtype}{int}           *ggg,
00410                         \textcolor{keywordtype}{int}           *index,
00411                         \textcolor{keywordtype}{int}           *p,
00412                         \textcolor{keywordtype}{int}           *q,
00413                         \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P)
00414 \{
00415   \textcolor{keywordtype}{int}   energy, \hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}, k, l, maxl, minl, c0, l1;
00416   \textcolor{keywordtype}{short} si, sj;
00417 
00418   dangles = P->\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}.\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles};
00419   si      = S[i + 1];
00420   sj      = S[j - 1];
00421   energy  = 0;
00422 
00423   \textcolor{keywordflow}{if} (dangles == 2)
00424     energy += P->mismatchI[type][si][sj];
00425 
00426   \textcolor{keywordflow}{if} (type > 2)
00427     energy += P->TerminalAU;
00428 
00429   k = i + 1;
00430   \textcolor{keywordflow}{if} (S[k] == 3) \{
00431     \textcolor{keywordflow}{if} (k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{
00432       minl  = j - i + k - MAXLOOP - 2;
00433       c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00434       minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minl);
00435       c0    = j - 3;
00436       maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00437       maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxl);
00438       \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{
00439         \textcolor{keywordflow}{if} (S[l] != 3)
00440           \textcolor{keywordflow}{continue};
00441 
00442         \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + P->internal\_loop[j - l - 1]) \{
00443           *p  = k;
00444           *q  = l;
00445           \textcolor{keywordflow}{return} 1;
00446         \}
00447       \}
00448     \}
00449   \}
00450 
00451   \textcolor{keywordflow}{for} (k = i + 2;
00452        k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
00453        k++) \{
00454     l1 = k - i - 1;
00455     \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00456       \textcolor{keywordflow}{break};
00457 
00458     \textcolor{keywordflow}{if} (S[k] != 3)
00459       \textcolor{keywordflow}{continue};
00460 
00461     minl  = j - i + k - MAXLOOP - 2;
00462     c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00463     minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minl);
00464     c0    = j - 1;
00465     maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00466     maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxl);
00467     \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{
00468       \textcolor{keywordflow}{if} (S[l] != 3)
00469         \textcolor{keywordflow}{continue};
00470 
00471       \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + P->internal\_loop[l1 + j - l - 1]) \{
00472         *p  = k;
00473         *q  = l;
00474         \textcolor{keywordflow}{return} 1;
00475       \}
00476     \}
00477   \}
00478 
00479   l = j - 1;
00480   \textcolor{keywordflow}{if} (S[l] == 3)
00481     \textcolor{keywordflow}{for} (k = i + 4;
00482          k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
00483          k++) \{
00484       l1 = k - i - 1;
00485       \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00486         \textcolor{keywordflow}{break};
00487 
00488       \textcolor{keywordflow}{if} (S[k] != 3)
00489         \textcolor{keywordflow}{continue};
00490 
00491       \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + P->internal\_loop[l1]) \{
00492         *p  = k;
00493         *q  = l;
00494         \textcolor{keywordflow}{return} 1;
00495       \}
00496     \}
00497 
00498   \textcolor{keywordflow}{return} 0;
00499 \}
00500 
00501 
00502 INLINE PRIVATE \textcolor{keywordtype}{int}
00503 backtrack\_GQuad\_IntLoop\_comparative(\textcolor{keywordtype}{int}           c,
00504                                     \textcolor{keywordtype}{int}           i,
00505                                     \textcolor{keywordtype}{int}           j,
00506                                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  *type,
00507                                     \textcolor{keywordtype}{short}         *S\_cons,
00508                                     \textcolor{keywordtype}{short}         **S5,
00509                                     \textcolor{keywordtype}{short}         **S3,
00510                                     \textcolor{keywordtype}{int}           *ggg,
00511                                     \textcolor{keywordtype}{int}           *index,
00512                                     \textcolor{keywordtype}{int}           *p,
00513                                     \textcolor{keywordtype}{int}           *q,
00514                                     \textcolor{keywordtype}{int}           n\_seq,
00515                                     \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P)
00516 \{
00517   \textcolor{keywordtype}{int} energy, \hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}, k, l, maxl, minl, c0, l1, ss, tt;
00518 
00519   dangles = P->\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}.\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles};
00520   energy  = 0;
00521 
00522   \textcolor{keywordflow}{for} (ss = 0; ss < n\_seq; ss++) \{
00523     tt = type[ss];
00524     \textcolor{keywordflow}{if} (tt == 0)
00525       tt = 7;
00526 
00527     \textcolor{keywordflow}{if} (dangles == 2)
00528       energy += P->mismatchI[tt][S3[ss][i]][S5[ss][j]];
00529 
00530     \textcolor{keywordflow}{if} (tt > 2)
00531       energy += P->TerminalAU;
00532   \}
00533 
00534   k = i + 1;
00535   \textcolor{keywordflow}{if} (S\_cons[k] == 3) \{
00536     \textcolor{keywordflow}{if} (k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{
00537       minl  = j - i + k - MAXLOOP - 2;
00538       c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00539       minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minl);
00540       c0    = j - 3;
00541       maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00542       maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxl);
00543       \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{
00544         \textcolor{keywordflow}{if} (S\_cons[l] != 3)
00545           \textcolor{keywordflow}{continue};
00546 
00547         \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + n\_seq * P->internal\_loop[j - l - 1]) \{
00548           *p  = k;
00549           *q  = l;
00550           \textcolor{keywordflow}{return} 1;
00551         \}
00552       \}
00553     \}
00554   \}
00555 
00556   \textcolor{keywordflow}{for} (k = i + 2;
00557        k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
00558        k++) \{
00559     l1 = k - i - 1;
00560     \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00561       \textcolor{keywordflow}{break};
00562 
00563     \textcolor{keywordflow}{if} (S\_cons[k] != 3)
00564       \textcolor{keywordflow}{continue};
00565 
00566     minl  = j - i + k - MAXLOOP - 2;
00567     c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00568     minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minl);
00569     c0    = j - 1;
00570     maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00571     maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxl);
00572     \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{
00573       \textcolor{keywordflow}{if} (S\_cons[l] != 3)
00574         \textcolor{keywordflow}{continue};
00575 
00576       \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + n\_seq * P->internal\_loop[l1 + j - l - 1]) \{
00577         *p  = k;
00578         *q  = l;
00579         \textcolor{keywordflow}{return} 1;
00580       \}
00581     \}
00582   \}
00583 
00584   l = j - 1;
00585   \textcolor{keywordflow}{if} (S\_cons[l] == 3)
00586     \textcolor{keywordflow}{for} (k = i + 4;
00587          k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
00588          k++) \{
00589       l1 = k - i - 1;
00590       \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00591         \textcolor{keywordflow}{break};
00592 
00593       \textcolor{keywordflow}{if} (S\_cons[k] != 3)
00594         \textcolor{keywordflow}{continue};
00595 
00596       \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + n\_seq * P->internal\_loop[l1]) \{
00597         *p  = k;
00598         *q  = l;
00599         \textcolor{keywordflow}{return} 1;
00600       \}
00601     \}
00602 
00603   \textcolor{keywordflow}{return} 0;
00604 \}
00605 
00606 
00623 INLINE PRIVATE \textcolor{keywordtype}{int}
\Hypertarget{gquad_8h_source_l00624}\hyperlink{group__gquads_ga7b371308fa5a45c7ac353ef6ed1014de}{00624} \hyperlink{group__gquads_ga7b371308fa5a45c7ac353ef6ed1014de}{backtrack\_GQuad\_IntLoop\_L}(\textcolor{keywordtype}{int}           c,
00625                           \textcolor{keywordtype}{int}           i,
00626                           \textcolor{keywordtype}{int}           j,
00627                           \textcolor{keywordtype}{int}           type,
00628                           \textcolor{keywordtype}{short}         *S,
00629                           \textcolor{keywordtype}{int}           **ggg,
00630                           \textcolor{keywordtype}{int}           maxdist,
00631                           \textcolor{keywordtype}{int}           *p,
00632                           \textcolor{keywordtype}{int}           *q,
00633                           \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P)
00634 \{
00635   \textcolor{keywordtype}{int}   energy, \hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}, k, l, maxl, minl, c0, l1;
00636   \textcolor{keywordtype}{short} si, sj;
00637 
00638   dangles = P->\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}.\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles};
00639   si      = S[i + 1];
00640   sj      = S[j - 1];
00641   energy  = 0;
00642 
00643   \textcolor{keywordflow}{if} (dangles == 2)
00644     energy += P->mismatchI[type][si][sj];
00645 
00646   \textcolor{keywordflow}{if} (type > 2)
00647     energy += P->TerminalAU;
00648 
00649   k = i + 1;
00650   \textcolor{keywordflow}{if} (S[k] == 3) \{
00651     \textcolor{keywordflow}{if} (k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{
00652       minl  = j - i + k - MAXLOOP - 2;
00653       c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00654       minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minl);
00655       c0    = j - 3;
00656       maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00657       maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxl);
00658       \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{
00659         \textcolor{keywordflow}{if} (S[l] != 3)
00660           \textcolor{keywordflow}{continue};
00661 
00662         \textcolor{keywordflow}{if} (c == energy + ggg[k][l - k] + P->internal\_loop[j - l - 1]) \{
00663           *p  = k;
00664           *q  = l;
00665           \textcolor{keywordflow}{return} 1;
00666         \}
00667       \}
00668     \}
00669   \}
00670 
00671   \textcolor{keywordflow}{for} (k = i + 2;
00672        k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
00673        k++) \{
00674     l1 = k - i - 1;
00675     \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00676       \textcolor{keywordflow}{break};
00677 
00678     \textcolor{keywordflow}{if} (S[k] != 3)
00679       \textcolor{keywordflow}{continue};
00680 
00681     minl  = j - i + k - MAXLOOP - 2;
00682     c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00683     minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minl);
00684     c0    = j - 1;
00685     maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00686     maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxl);
00687     \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{
00688       \textcolor{keywordflow}{if} (S[l] != 3)
00689         \textcolor{keywordflow}{continue};
00690 
00691       \textcolor{keywordflow}{if} (c == energy + ggg[k][l - k] + P->internal\_loop[l1 + j - l - 1]) \{
00692         *p  = k;
00693         *q  = l;
00694         \textcolor{keywordflow}{return} 1;
00695       \}
00696     \}
00697   \}
00698 
00699   l = j - 1;
00700   \textcolor{keywordflow}{if} (S[l] == 3)
00701     \textcolor{keywordflow}{for} (k = i + 4;
00702          k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
00703          k++) \{
00704       l1 = k - i - 1;
00705       \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00706         \textcolor{keywordflow}{break};
00707 
00708       \textcolor{keywordflow}{if} (S[k] != 3)
00709         \textcolor{keywordflow}{continue};
00710 
00711       \textcolor{keywordflow}{if} (c == energy + ggg[k][l - k] + P->internal\_loop[l1]) \{
00712         *p  = k;
00713         *q  = l;
00714         \textcolor{keywordflow}{return} 1;
00715       \}
00716     \}
00717 
00718   \textcolor{keywordflow}{return} 0;
00719 \}
00720 
00721 
00722 INLINE PRIVATE \textcolor{keywordtype}{int}
00723 backtrack\_GQuad\_IntLoop\_L\_comparative(\textcolor{keywordtype}{int}           c,
00724                                       \textcolor{keywordtype}{int}           i,
00725                                       \textcolor{keywordtype}{int}           j,
00726                                       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  *type,
00727                                       \textcolor{keywordtype}{short}         *S\_cons,
00728                                       \textcolor{keywordtype}{short}         **S5,
00729                                       \textcolor{keywordtype}{short}         **S3,
00730                                       \textcolor{keywordtype}{int}           **ggg,
00731                                       \textcolor{keywordtype}{int}           *p,
00732                                       \textcolor{keywordtype}{int}           *q,
00733                                       \textcolor{keywordtype}{int}           n\_seq,
00734                                       \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P)
00735 \{
00736   \textcolor{comment}{/*}
00737 \textcolor{comment}{   * The case that is handled here actually resembles something like}
00738 \textcolor{comment}{   * an interior loop where the enclosing base pair is of regular}
00739 \textcolor{comment}{   * kind and the enclosed pair is not a canonical one but a g-quadruplex}
00740 \textcolor{comment}{   * that should then be decomposed further...}
00741 \textcolor{comment}{   */}
00742   \textcolor{keywordtype}{int} mm, dangle\_model, k, l, maxl, minl, c0, l1, ss, tt;
00743 
00744   dangle\_model = P->\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}.\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles};
00745 
00746   mm = 0;
00747   \textcolor{keywordflow}{for} (ss = 0; ss < n\_seq; ss++) \{
00748     tt = type[ss];
00749 
00750     \textcolor{keywordflow}{if} (dangle\_model == 2)
00751       mm += P->mismatchI[tt][S3[ss][i]][S5[ss][j]];
00752 
00753     \textcolor{keywordflow}{if} (tt > 2)
00754       mm += P->TerminalAU;
00755   \}
00756 
00757   \textcolor{keywordflow}{for} (k = i + 2;
00758        k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
00759        k++) \{
00760     \textcolor{keywordflow}{if} (S\_cons[k] != 3)
00761       \textcolor{keywordflow}{continue};
00762 
00763     l1 = k - i - 1;
00764     \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00765       \textcolor{keywordflow}{break};
00766 
00767     minl  = j - i + k - MAXLOOP - 2;
00768     c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00769     minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minl);
00770     c0    = j - 1;
00771     maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00772     maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxl);
00773     \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{
00774       \textcolor{keywordflow}{if} (S\_cons[l] != 3)
00775         \textcolor{keywordflow}{continue};
00776 
00777       c0 = mm + ggg[k][l - k] + n\_seq * P->internal\_loop[l1 + j - l - 1];
00778       \textcolor{keywordflow}{if} (c == c0) \{
00779         *p  = k;
00780         *q  = l;
00781         \textcolor{keywordflow}{return} 1;
00782       \}
00783     \}
00784   \}
00785   k = i + 1;
00786   \textcolor{keywordflow}{if} (S\_cons[k] == 3) \{
00787     \textcolor{keywordflow}{if} (k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{
00788       minl  = j - i + k - MAXLOOP - 2;
00789       c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00790       minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minl);
00791       c0    = j - 3;
00792       maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00793       maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxl);
00794       \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{
00795         \textcolor{keywordflow}{if} (S\_cons[l] != 3)
00796           \textcolor{keywordflow}{continue};
00797 
00798         \textcolor{keywordflow}{if} (c == mm + ggg[k][l - k] + n\_seq * P->internal\_loop[j - l - 1]) \{
00799           *p  = k;
00800           *q  = l;
00801           \textcolor{keywordflow}{return} 1;
00802         \}
00803       \}
00804     \}
00805   \}
00806 
00807   l = j - 1;
00808   \textcolor{keywordflow}{if} (S\_cons[l] == 3) \{
00809     \textcolor{keywordflow}{for} (k = i + 4; k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE; k++) \{
00810       l1 = k - i - 1;
00811       \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00812         \textcolor{keywordflow}{break};
00813 
00814       \textcolor{keywordflow}{if} (S\_cons[k] != 3)
00815         \textcolor{keywordflow}{continue};
00816 
00817       \textcolor{keywordflow}{if} (c == mm + ggg[k][l - k] + n\_seq * P->internal\_loop[l1]) \{
00818         *p  = k;
00819         *q  = l;
00820         \textcolor{keywordflow}{return} 1;
00821       \}
00822     \}
00823   \}
00824 
00825   \textcolor{keywordflow}{return} 0;
00826 \}
00827 
00828 
00829 PRIVATE INLINE
00830 \textcolor{keywordtype}{int}
00831 E\_GQuad\_IntLoop(\textcolor{keywordtype}{int}           i,
00832                 \textcolor{keywordtype}{int}           j,
00833                 \textcolor{keywordtype}{int}           type,
00834                 \textcolor{keywordtype}{short}         *S,
00835                 \textcolor{keywordtype}{int}           *ggg,
00836                 \textcolor{keywordtype}{int}           *index,
00837                 \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P)
00838 \{
00839   \textcolor{keywordtype}{int}   energy, ge, \hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}, p, q, l1, minq, maxq, c0;
00840   \textcolor{keywordtype}{short} si, sj;
00841 
00842   dangles = P->\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}.\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles};
00843   si      = S[i + 1];
00844   sj      = S[j - 1];
00845   energy  = 0;
00846 
00847   \textcolor{keywordflow}{if} (dangles == 2)
00848     energy += P->mismatchI[type][si][sj];
00849 
00850   \textcolor{keywordflow}{if} (type > 2)
00851     energy += P->TerminalAU;
00852 
00853   ge = \hyperlink{constants_8h_a12c2040f25d8e3a7b9e1c2024c618cb6}{INF};
00854 
00855   p = i + 1;
00856   \textcolor{keywordflow}{if} (S[p] == 3) \{
00857     \textcolor{keywordflow}{if} (p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{
00858       minq  = j - i + p - MAXLOOP - 2;
00859       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00860       minq  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minq);
00861       c0    = j - 3;
00862       maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00863       maxq  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxq);
00864       \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{
00865         \textcolor{keywordflow}{if} (S[q] != 3)
00866           \textcolor{keywordflow}{continue};
00867 
00868         c0  = energy + ggg[index[q] + p] + P->internal\_loop[j - q - 1];
00869         ge  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(ge, c0);
00870       \}
00871     \}
00872   \}
00873 
00874   \textcolor{keywordflow}{for} (p = i + 2;
00875        p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
00876        p++) \{
00877     l1 = p - i - 1;
00878     \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00879       \textcolor{keywordflow}{break};
00880 
00881     \textcolor{keywordflow}{if} (S[p] != 3)
00882       \textcolor{keywordflow}{continue};
00883 
00884     minq  = j - i + p - MAXLOOP - 2;
00885     c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00886     minq  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minq);
00887     c0    = j - 1;
00888     maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00889     maxq  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxq);
00890     \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{
00891       \textcolor{keywordflow}{if} (S[q] != 3)
00892         \textcolor{keywordflow}{continue};
00893 
00894       c0  = energy + ggg[index[q] + p] + P->internal\_loop[l1 + j - q - 1];
00895       ge  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(ge, c0);
00896     \}
00897   \}
00898 
00899   q = j - 1;
00900   \textcolor{keywordflow}{if} (S[q] == 3)
00901     \textcolor{keywordflow}{for} (p = i + 4;
00902          p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
00903          p++) \{
00904       l1 = p - i - 1;
00905       \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00906         \textcolor{keywordflow}{break};
00907 
00908       \textcolor{keywordflow}{if} (S[p] != 3)
00909         \textcolor{keywordflow}{continue};
00910 
00911       c0  = energy + ggg[index[q] + p] + P->internal\_loop[l1];
00912       ge  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(ge, c0);
00913     \}
00914 
00915 \textcolor{preprocessor}{#if 0}
00916   \textcolor{comment}{/* here comes the additional stuff for the odd dangle models */}
00917   \textcolor{keywordflow}{if} (dangles % 1) \{
00918     en1 = energy + P->dangle5[type][si];
00919     en2 = energy + P->dangle5[type][sj];
00920     en3 = energy + P->mismatchI[type][si][sj];
00921 
00922     \textcolor{comment}{/* first case with 5' dangle (i.e. j-1) onto enclosing pair */}
00923     p = i + 1;
00924     \textcolor{keywordflow}{if} (S[p] == 3) \{
00925       \textcolor{keywordflow}{if} (p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{
00926         minq  = j - i + p - MAXLOOP - 2;
00927         c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00928         minq  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minq);
00929         c0    = j - 4;
00930         maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00931         maxq  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxq);
00932         \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{
00933           \textcolor{keywordflow}{if} (S[q] != 3)
00934             \textcolor{keywordflow}{continue};
00935 
00936           c0  = en1 + ggg[index[q] + p] + P->internal\_loop[j - q - 1];
00937           ge  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(ge, c0);
00938         \}
00939       \}
00940     \}
00941 
00942     \textcolor{keywordflow}{for} (p = i + 2; p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE; p++) \{
00943       l1 = p - i - 1;
00944       \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00945         \textcolor{keywordflow}{break};
00946 
00947       \textcolor{keywordflow}{if} (S[p] != 3)
00948         \textcolor{keywordflow}{continue};
00949 
00950       minq  = j - i + p - MAXLOOP - 2;
00951       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
00952       minq  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minq);
00953       c0    = j - 2;
00954       maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
00955       maxq  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxq);
00956       \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{
00957         \textcolor{keywordflow}{if} (S[q] != 3)
00958           \textcolor{keywordflow}{continue};
00959 
00960         c0  = en1 + ggg[index[q] + p] + P->internal\_loop[l1 + j - q - 1];
00961         ge  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(ge, c0);
00962       \}
00963     \}
00964 
00965     q = j - 2;
00966     \textcolor{keywordflow}{if} (S[q] == 3)
00967       \textcolor{keywordflow}{for} (p = i + 4; p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE; p++) \{
00968         l1 = p - i - 1;
00969         \textcolor{keywordflow}{if} (l1 > MAXLOOP)
00970           \textcolor{keywordflow}{break};
00971 
00972         \textcolor{keywordflow}{if} (S[p] != 3)
00973           \textcolor{keywordflow}{continue};
00974 
00975         c0  = en1 + ggg[index[q] + p] + P->internal\_loop[l1 + 1];
00976         ge  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(ge, c0);
00977       \}
00978 
00979     \textcolor{comment}{/* second case with 3' dangle (i.e. i+1) onto enclosing pair */}
00980   \}
00981 
00982 \textcolor{preprocessor}{#endif}
00983   \textcolor{keywordflow}{return} ge;
00984 \}
00985 
00986 
00987 PRIVATE INLINE
00988 \textcolor{keywordtype}{int} *
00989 E\_GQuad\_IntLoop\_exhaustive(\textcolor{keywordtype}{int}          i,
00990                            \textcolor{keywordtype}{int}          j,
00991                            \textcolor{keywordtype}{int}          **p\_p,
00992                            \textcolor{keywordtype}{int}          **q\_p,
00993                            \textcolor{keywordtype}{int}          type,
00994                            \textcolor{keywordtype}{short}        *S,
00995                            \textcolor{keywordtype}{int}          *ggg,
00996                            \textcolor{keywordtype}{int}          threshold,
00997                            \textcolor{keywordtype}{int}          *index,
00998                            \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P)
00999 \{
01000   \textcolor{keywordtype}{int}   energy, *ge, \hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}, p, q, l1, minq, maxq, c0;
01001   \textcolor{keywordtype}{short} si, sj;
01002   \textcolor{keywordtype}{int}   cnt = 0;
01003 
01004   dangles = P->\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}.\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles};
01005   si      = S[i + 1];
01006   sj      = S[j - 1];
01007   energy  = 0;
01008 
01009   \textcolor{keywordflow}{if} (dangles == 2)
01010     energy += P->mismatchI[type][si][sj];
01011 
01012   \textcolor{keywordflow}{if} (type > 2)
01013     energy += P->TerminalAU;
01014 
01015   \textcolor{comment}{/* guess how many gquads are possible in interval [i+1,j-1] */}
01016   *p\_p  = (\textcolor{keywordtype}{int} *)\hyperlink{group__utils_gaf37a0979367c977edfb9da6614eebe99}{vrna\_alloc}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 256);
01017   *q\_p  = (\textcolor{keywordtype}{int} *)\hyperlink{group__utils_gaf37a0979367c977edfb9da6614eebe99}{vrna\_alloc}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 256);
01018   ge    = (\textcolor{keywordtype}{int} *)\hyperlink{group__utils_gaf37a0979367c977edfb9da6614eebe99}{vrna\_alloc}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 256);
01019 
01020   p = i + 1;
01021   \textcolor{keywordflow}{if} (S[p] == 3) \{
01022     \textcolor{keywordflow}{if} (p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{
01023       minq  = j - i + p - MAXLOOP - 2;
01024       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
01025       minq  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minq);
01026       c0    = j - 3;
01027       maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
01028       maxq  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxq);
01029       \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{
01030         \textcolor{keywordflow}{if} (S[q] != 3)
01031           \textcolor{keywordflow}{continue};
01032 
01033         c0 = energy + ggg[index[q] + p] + P->internal\_loop[j - q - 1];
01034         \textcolor{keywordflow}{if} (c0 <= threshold) \{
01035           ge[cnt]       = energy + P->internal\_loop[j - q - 1];
01036           (*p\_p)[cnt]   = p;
01037           (*q\_p)[cnt++] = q;
01038         \}
01039       \}
01040     \}
01041   \}
01042 
01043   \textcolor{keywordflow}{for} (p = i + 2;
01044        p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
01045        p++) \{
01046     l1 = p - i - 1;
01047     \textcolor{keywordflow}{if} (l1 > MAXLOOP)
01048       \textcolor{keywordflow}{break};
01049 
01050     \textcolor{keywordflow}{if} (S[p] != 3)
01051       \textcolor{keywordflow}{continue};
01052 
01053     minq  = j - i + p - MAXLOOP - 2;
01054     c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
01055     minq  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minq);
01056     c0    = j - 1;
01057     maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
01058     maxq  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxq);
01059     \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{
01060       \textcolor{keywordflow}{if} (S[q] != 3)
01061         \textcolor{keywordflow}{continue};
01062 
01063       c0 = energy + ggg[index[q] + p] + P->internal\_loop[l1 + j - q - 1];
01064       \textcolor{keywordflow}{if} (c0 <= threshold) \{
01065         ge[cnt]       = energy + P->internal\_loop[l1 + j - q - 1];
01066         (*p\_p)[cnt]   = p;
01067         (*q\_p)[cnt++] = q;
01068       \}
01069     \}
01070   \}
01071 
01072   q = j - 1;
01073   \textcolor{keywordflow}{if} (S[q] == 3)
01074     \textcolor{keywordflow}{for} (p = i + 4;
01075          p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
01076          p++) \{
01077       l1 = p - i - 1;
01078       \textcolor{keywordflow}{if} (l1 > MAXLOOP)
01079         \textcolor{keywordflow}{break};
01080 
01081       \textcolor{keywordflow}{if} (S[p] != 3)
01082         \textcolor{keywordflow}{continue};
01083 
01084       c0 = energy + ggg[index[q] + p] + P->internal\_loop[l1];
01085       \textcolor{keywordflow}{if} (c0 <= threshold) \{
01086         ge[cnt]       = energy + P->internal\_loop[l1];
01087         (*p\_p)[cnt]   = p;
01088         (*q\_p)[cnt++] = q;
01089       \}
01090     \}
01091 
01092   (*p\_p)[cnt] = -1;
01093 
01094   \textcolor{keywordflow}{return} ge;
01095 \}
01096 
01097 
01098 PRIVATE INLINE
01099 \textcolor{keywordtype}{int}
01100 E\_GQuad\_IntLoop\_L(\textcolor{keywordtype}{int}           i,
01101                   \textcolor{keywordtype}{int}           j,
01102                   \textcolor{keywordtype}{int}           type,
01103                   \textcolor{keywordtype}{short}         *S,
01104                   \textcolor{keywordtype}{int}           **ggg,
01105                   \textcolor{keywordtype}{int}           maxdist,
01106                   \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P)
01107 \{
01108   \textcolor{keywordtype}{int}   energy, ge, \hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}, p, q, l1, minq, maxq, c0;
01109   \textcolor{keywordtype}{short} si, sj;
01110 
01111   dangles = P->\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}.\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles};
01112   si      = S[i + 1];
01113   sj      = S[j - 1];
01114   energy  = 0;
01115 
01116   \textcolor{keywordflow}{if} (dangles == 2)
01117     energy += P->mismatchI[type][si][sj];
01118 
01119   \textcolor{keywordflow}{if} (type > 2)
01120     energy += P->TerminalAU;
01121 
01122   ge = \hyperlink{constants_8h_a12c2040f25d8e3a7b9e1c2024c618cb6}{INF};
01123 
01124   p = i + 1;
01125   \textcolor{keywordflow}{if} (S[p] == 3) \{
01126     \textcolor{keywordflow}{if} (p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{
01127       minq  = j - i + p - MAXLOOP - 2;
01128       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
01129       minq  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minq);
01130       c0    = j - 3;
01131       maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
01132       maxq  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxq);
01133       \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{
01134         \textcolor{keywordflow}{if} (S[q] != 3)
01135           \textcolor{keywordflow}{continue};
01136 
01137         c0  = energy + ggg[p][q - p] + P->internal\_loop[j - q - 1];
01138         ge  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(ge, c0);
01139       \}
01140     \}
01141   \}
01142 
01143   \textcolor{keywordflow}{for} (p = i + 2;
01144        p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
01145        p++) \{
01146     l1 = p - i - 1;
01147     \textcolor{keywordflow}{if} (l1 > MAXLOOP)
01148       \textcolor{keywordflow}{break};
01149 
01150     \textcolor{keywordflow}{if} (S[p] != 3)
01151       \textcolor{keywordflow}{continue};
01152 
01153     minq  = j - i + p - MAXLOOP - 2;
01154     c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
01155     minq  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(c0, minq);
01156     c0    = j - 1;
01157     maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
01158     maxq  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(c0, maxq);
01159     \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{
01160       \textcolor{keywordflow}{if} (S[q] != 3)
01161         \textcolor{keywordflow}{continue};
01162 
01163       c0  = energy + ggg[p][q - p] + P->internal\_loop[l1 + j - q - 1];
01164       ge  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(ge, c0);
01165     \}
01166   \}
01167 
01168   q = j - 1;
01169   \textcolor{keywordflow}{if} (S[q] == 3)
01170     \textcolor{keywordflow}{for} (p = i + 4;
01171          p < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
01172          p++) \{
01173       l1 = p - i - 1;
01174       \textcolor{keywordflow}{if} (l1 > MAXLOOP)
01175         \textcolor{keywordflow}{break};
01176 
01177       \textcolor{keywordflow}{if} (S[p] != 3)
01178         \textcolor{keywordflow}{continue};
01179 
01180       c0  = energy + ggg[p][q - p] + P->internal\_loop[l1];
01181       ge  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(ge, c0);
01182     \}
01183 
01184   \textcolor{keywordflow}{return} ge;
01185 \}
01186 
01187 
01188 PRIVATE INLINE
01189 \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}
01190 exp\_E\_GQuad\_IntLoop(\textcolor{keywordtype}{int}               i,
01191                     \textcolor{keywordtype}{int}               j,
01192                     \textcolor{keywordtype}{int}               type,
01193                     \textcolor{keywordtype}{short}             *S,
01194                     \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}        *G,
01195                     \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}        *scale,
01196                     \textcolor{keywordtype}{int}               *index,
01197                     \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}  *pf)
01198 \{
01199   \textcolor{keywordtype}{int}         k, l, minl, maxl, u, r;
01200   \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}  q, qe;
01201   \textcolor{keywordtype}{double}      *expintern;
01202   \textcolor{keywordtype}{short}       si, sj;
01203 
01204   q         = 0;
01205   si        = S[i + 1];
01206   sj        = S[j - 1];
01207   qe        = (\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL})pf->expmismatchI[type][si][sj];
01208   expintern = &(pf->expinternal[0]);
01209 
01210   \textcolor{keywordflow}{if} (type > 2)
01211     qe *= (\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL})pf->expTermAU;
01212 
01213   k = i + 1;
01214   if (S[k] == 3) \{
01215     \textcolor{keywordflow}{if} (k < j - VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{
01216       minl  = j - MAXLOOP - 1;
01217       u     = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
01218       minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(u, minl);
01219       u     = j - 3;
01220       maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
01221       maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(u, maxl);
01222       \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{
01223         \textcolor{keywordflow}{if} (S[l] != 3)
01224           \textcolor{keywordflow}{continue};
01225 
01226         \textcolor{keywordflow}{if} (G[index[k] - l] == 0.)
01227           \textcolor{keywordflow}{continue};
01228 
01229         q += qe
01230              * G[index[k] - l]
01231              * (\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL})expintern[j - l - 1]
01232              * scale[j - l + 1];
01233       \}
01234     \}
01235   \}
01236 
01237   \textcolor{keywordflow}{for} (k = i + 2;
01238        k <= j - VRNA\_GQUAD\_MIN\_BOX\_SIZE;
01239        k++) \{
01240     u = k - i - 1;
01241     \textcolor{keywordflow}{if} (u > MAXLOOP)
01242       \textcolor{keywordflow}{break};
01243 
01244     \textcolor{keywordflow}{if} (S[k] != 3)
01245       \textcolor{keywordflow}{continue};
01246 
01247     minl  = j - i + k - MAXLOOP - 2;
01248     r     = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE - 1;
01249     minl  = \hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}(r, minl);
01250     maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;
01251     r     = j - 1;
01252     maxl  = \hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}(r, maxl);
01253     \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{
01254       \textcolor{keywordflow}{if} (S[l] != 3)
01255         \textcolor{keywordflow}{continue};
01256 
01257       \textcolor{keywordflow}{if} (G[index[k] - l] == 0.)
01258         \textcolor{keywordflow}{continue};
01259 
01260       q += qe
01261            * G[index[k] - l]
01262            * (\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL})expintern[u + j - l - 1]
01263            * scale[u + j - l + 1];
01264     \}
01265   \}
01266 
01267   l = j - 1;
01268   \textcolor{keywordflow}{if} (S[l] == 3)
01269     \textcolor{keywordflow}{for} (k = i + 4; k <= j - VRNA\_GQUAD\_MIN\_BOX\_SIZE; k++) \{
01270       u = k - i - 1;
01271       \textcolor{keywordflow}{if} (u > MAXLOOP)
01272         \textcolor{keywordflow}{break};
01273 
01274       \textcolor{keywordflow}{if} (S[k] != 3)
01275         \textcolor{keywordflow}{continue};
01276 
01277       \textcolor{keywordflow}{if} (G[index[k] - l] == 0.)
01278         \textcolor{keywordflow}{continue};
01279 
01280       q += qe
01281            * G[index[k] - l]
01282            * (\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL})expintern[u]
01283            * scale[u + 2];
01284     \}
01285 
01286   \textcolor{keywordflow}{return} q;
01287 \}
01288 
01289 
01295 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
